---
phase: 01-foundation-data-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - next.config.ts
  - src/app/layout.tsx
  - src/app/page.tsx
  - src/app/transactions/page.tsx
  - src/app/options/page.tsx
  - src/app/dividends/page.tsx
  - src/app/deposits/page.tsx
  - src/app/performance/page.tsx
  - src/styles/globals.css
  - src/components/layout/app-sidebar.tsx
  - src/components/layout/theme-provider.tsx
  - .env.example
autonomous: true

must_haves:
  truths:
    - "The Next.js app starts without errors and renders a dark-themed page"
    - "Sidebar navigation shows Portfolio, Transactions, Options, Dividends, Deposits, Performance links"
    - "Clicking each sidebar link navigates to the correct page"
    - "On mobile viewport (< 768px) the sidebar collapses and a hamburger trigger opens it as a sheet overlay"
    - "The dark theme uses finance-standard green for gains and red for losses as CSS custom properties"
  artifacts:
    - path: "src/app/layout.tsx"
      provides: "Root layout with ThemeProvider, SidebarProvider, AppSidebar, SidebarTrigger"
      contains: "SidebarProvider"
    - path: "src/components/layout/app-sidebar.tsx"
      provides: "Sidebar with 6 navigation items and active state highlighting"
      contains: "navItems"
    - path: "src/components/layout/theme-provider.tsx"
      provides: "next-themes wrapper with dark default, class attribute"
      contains: "defaultTheme"
    - path: "src/styles/globals.css"
      provides: "Tailwind v4 CSS-first config with dark mode variant and finance color tokens"
      contains: "@custom-variant dark"
    - path: "src/app/page.tsx"
      provides: "Portfolio placeholder page"
    - path: "src/app/transactions/page.tsx"
      provides: "Transactions placeholder page"
    - path: "src/app/options/page.tsx"
      provides: "Options placeholder page"
    - path: "src/app/dividends/page.tsx"
      provides: "Dividends placeholder page"
    - path: "src/app/deposits/page.tsx"
      provides: "Deposits placeholder page"
    - path: "src/app/performance/page.tsx"
      provides: "Performance placeholder page"
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/components/layout/theme-provider.tsx"
      via: "import ThemeProvider"
      pattern: "import.*ThemeProvider"
    - from: "src/app/layout.tsx"
      to: "src/components/layout/app-sidebar.tsx"
      via: "import AppSidebar"
      pattern: "import.*AppSidebar"
    - from: "src/components/layout/app-sidebar.tsx"
      to: "next/link"
      via: "Link component for navigation"
      pattern: "import Link"
---

<objective>
Scaffold the Next.js 16 dashboard project with dark theme, responsive sidebar navigation, and placeholder pages for all 6 routes.

Purpose: Establishes the application shell that all subsequent phases build upon. Every future page, component, and data fetch lives inside this project structure. The dark theme and sidebar layout are the foundation for the finance dashboard aesthetic.

Output: A working Next.js app in `dashboard/` with dark-themed sidebar navigation, 6 placeholder pages, and responsive mobile behaviour.
</objective>

<execution_context>
@/Users/skylight/.claude/sky/workflows/execute-plan.md
@/Users/skylight/.claude/sky/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-data-migration/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Next.js project and install dependencies</name>
  <files>
    package.json
    tsconfig.json
    next.config.ts
    .env.example
  </files>
  <action>
    Run `pnpm create next-app dashboard --typescript --tailwind --eslint --app --use-pnpm --yes` from the project root (`/Users/skylight/development/personal/nodes/folio`). This creates the `dashboard/` directory with Next.js 16, Tailwind v4, TypeScript, and App Router.

    After creation, cd into `dashboard/` and:

    1. Run `pnpm dlx shadcn@latest init` — select: New York style, default settings. This will set up shadcn/ui with components.json and update globals.css with CSS variables.

    2. Run `pnpm dlx shadcn@latest add sidebar button separator tooltip` to install the sidebar component and its dependencies (includes radix-ui, lucide-react, tw-animate-css).

    3. Run `pnpm install next-themes server-only` to add theme management and server-only import guard.

    4. Create `.env.example` with these placeholder variables (NO actual secrets):
    ```
    # NocoDB Connection
    NOCODB_BASE_URL=http://localhost:8080
    NOCODB_API_TOKEN=your_nocodb_api_token

    # Table IDs (populated after running migration script)
    NOCODB_TABLE_SYMBOLS=
    NOCODB_TABLE_TRANSACTIONS=
    NOCODB_TABLE_OPTIONS=
    NOCODB_TABLE_DEPOSITS=
    NOCODB_TABLE_DIVIDENDS=
    NOCODB_TABLE_SNAPSHOTS=
    NOCODB_TABLE_PRICE_HISTORY=
    NOCODB_TABLE_SETTINGS=
    ```

    5. Add `.env.local` to `.gitignore` if not already there (create-next-app typically includes this).

    IMPORTANT: Do NOT use `tailwind.config.js` — Tailwind v4 uses CSS-first config. Do NOT install `tailwindcss-animate` — use `tw-animate-css` (shadcn handles this).
  </action>
  <verify>
    - `ls package.json` confirms the project exists
    - `cd dashboard && pnpm build` compiles without errors
    - `grep "next-themes" package.json` shows the dependency
    - `grep "server-only" package.json` shows the dependency
    - `ls src/components/ui/sidebar.tsx` confirms shadcn sidebar installed
  </verify>
  <done>
    Next.js 16 project exists at `dashboard/` with shadcn/ui (new-york style), next-themes, server-only, and sidebar component installed. Build succeeds.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure dark theme, sidebar layout, and placeholder pages</name>
  <files>
    src/styles/globals.css
    src/components/layout/theme-provider.tsx
    src/components/layout/app-sidebar.tsx
    src/app/layout.tsx
    src/app/page.tsx
    src/app/transactions/page.tsx
    src/app/options/page.tsx
    src/app/dividends/page.tsx
    src/app/deposits/page.tsx
    src/app/performance/page.tsx
  </files>
  <action>
    **globals.css:** Edit the existing globals.css that shadcn init created. Ensure it has:
    - `@import "tailwindcss";` at the top
    - `@import "tw-animate-css";` (shadcn may have added this)
    - `@custom-variant dark (&:where(.dark, .dark *));` for class-based dark mode
    - Inside `@theme` block, add finance color tokens:
      ```
      --color-gain: oklch(0.723 0.191 142.5);
      --color-loss: oklch(0.637 0.237 25.3);
      ```
    - Keep all existing shadcn CSS variables (the dark theme variables under `.dark` selector)

    **theme-provider.tsx:** Create `src/components/layout/theme-provider.tsx`:
    - "use client" directive at top
    - Export `ThemeProvider` wrapping `NextThemesProvider` from `next-themes`
    - Props: `attribute="class"`, `defaultTheme="dark"`, `enableSystem={false}`, `disableTransitionOnChange`
    - Accept and pass through `children: React.ReactNode`

    **app-sidebar.tsx:** Create `src/components/layout/app-sidebar.tsx`:
    - "use client" directive at top
    - Define `navItems` array with 6 items:
      - Portfolio: url="/", icon=BarChart3
      - Transactions: url="/transactions", icon=ArrowLeftRight
      - Options: url="/options", icon=Target
      - Dividends: url="/dividends", icon=Banknote
      - Deposits: url="/deposits", icon=PiggyBank
      - Performance: url="/performance", icon=TrendingUp
    - Icons from `lucide-react`
    - Use `usePathname()` from `next/navigation` to highlight the active nav item via `isActive` prop on `SidebarMenuButton`
    - Use shadcn Sidebar with `collapsible="icon"` for desktop icon-collapse mode
    - Structure: Sidebar > SidebarHeader (app name "Folio") > SidebarContent > SidebarGroup > SidebarGroupLabel("Dashboard") > SidebarGroupContent > SidebarMenu > map navItems to SidebarMenuItem > SidebarMenuButton (asChild, isActive) > Link
    - SidebarFooter: empty for now (Phase 2 adds "Last synced" indicator)
    - Use `<span>{item.title}</span>` inside Link (not `item.name`)

    **layout.tsx:** Replace the default root layout:
    - Import ThemeProvider and AppSidebar
    - Import `SidebarProvider`, `SidebarInset`, `SidebarTrigger` from `@/components/ui/sidebar`
    - `<html lang="en" suppressHydrationWarning>` to prevent next-themes hydration warning
    - Body structure:
      ```
      <ThemeProvider>
        <SidebarProvider>
          <AppSidebar />
          <SidebarInset>
            <header className="flex h-12 items-center gap-2 border-b px-4">
              <SidebarTrigger />
            </header>
            <main className="flex-1 p-4 md:p-6">{children}</main>
          </SidebarInset>
        </SidebarProvider>
      </ThemeProvider>
      ```
    - Keep the existing font imports (Inter or Geist from create-next-app)
    - Metadata: title "Folio", description "Personal investment dashboard"

    **Placeholder pages:** Create 6 pages, each as a simple Server Component with:
    - An h1 with the page name
    - A short paragraph: "Coming soon."
    - Styled with `text-foreground` classes to inherit the dark theme

    Page routes:
    - `src/app/page.tsx` — "Portfolio"
    - `src/app/transactions/page.tsx` — "Transactions"
    - `src/app/options/page.tsx` — "Options"
    - `src/app/dividends/page.tsx` — "Dividends"
    - `src/app/deposits/page.tsx` — "Deposits"
    - `src/app/performance/page.tsx` — "Performance"

    IMPORTANT: Do NOT include a `/tax` page — UK tax was deferred to v2.
    IMPORTANT: Use `@/components/ui/sidebar` import path (shadcn convention).
    IMPORTANT: The SidebarTrigger must be in the main content area (not inside the sidebar) so the hamburger button is visible on mobile.
  </action>
  <verify>
    - `cd dashboard && pnpm build` succeeds without errors
    - `grep "@custom-variant dark" src/styles/globals.css` confirms dark mode variant
    - `grep "defaultTheme.*dark" src/components/layout/theme-provider.tsx` confirms dark default
    - `grep "SidebarProvider" src/app/layout.tsx` confirms sidebar wiring
    - `grep "SidebarTrigger" src/app/layout.tsx` confirms mobile trigger
    - `ls src/app/transactions/page.tsx src/app/options/page.tsx src/app/dividends/page.tsx src/app/deposits/page.tsx src/app/performance/page.tsx` confirms all placeholder pages exist
  </verify>
  <done>
    The Next.js app builds successfully with dark theme by default, a responsive sidebar with 6 navigation links (Portfolio, Transactions, Options, Dividends, Deposits, Performance), active state highlighting, mobile hamburger collapse via SidebarTrigger, and placeholder pages at all 6 routes. Finance color tokens (gain green, loss red) are available as CSS custom properties.
  </done>
</task>

</tasks>

<verification>
1. `cd dashboard && pnpm build` — builds without errors
2. `cd dashboard && pnpm typecheck` — TypeScript compilation succeeds (if available, or `pnpm tsc --noEmit`)
3. All 6 route pages exist and export default components
4. The root layout wraps content in ThemeProvider > SidebarProvider > AppSidebar + SidebarInset
5. globals.css contains `@custom-variant dark`, `--color-gain`, `--color-loss`
6. theme-provider.tsx sets `defaultTheme="dark"` and `attribute="class"`
7. app-sidebar.tsx has 6 nav items with correct URLs and icons
8. `.env.example` exists with NocoDB placeholder variables
9. No `tailwind.config.js` file exists (Tailwind v4 CSS-first)
</verification>

<success_criteria>
- The dashboard renders a dark-themed shell with sidebar navigation
- All 6 navigation links route to their respective placeholder pages
- On mobile viewport, the sidebar collapses and a hamburger button opens it as a sheet overlay
- The build completes without TypeScript or compilation errors
- Finance color tokens (gain/loss) are defined in CSS custom properties
- Requirements covered: UI-01 (dark theme), UI-02 (sidebar navigation), UI-05 (responsive layout), UI-06 (hamburger collapse)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-data-migration/01-01-SUMMARY.md`
</output>
